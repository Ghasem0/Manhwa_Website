{% extends '_base.html' %}


{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}


{% block css %}
    <link rel="stylesheet" href="{% static 'css/manhwa_detail.css' %}">
{% endblock %}


{% block title %}
    {{ manhwa.title }} {% trans 'detail' %}
{% endblock %}


{% block content %}
    <div class="body">
        <div class="manhwa-cover">
            <img src="{{ manhwa.cover.url }}" alt="">
        </div>
        <br>
        <h1>{% trans 'english title' %} : {{ manhwa.en_title }}</h1>
        <h1>{% trans 'persian title' %} : {{ manhwa.fa_title }}</h1><br>
        <p>{% trans 'views count' %} : {{ manhwa.views_count }}</p>
        <br><br>
        <span>{% trans 'genres' %} : </span>
        {% for genre in manhwa.genres.all %}
            <a href="#" class="genre">{{ genre.title }}</a>
        {% endfor %}

       <br><br>
        <h3>{% trans 'summary' %} : </h3>
        <p>{{ manhwa.summary|safe|linebreaks }}</p>
        <br><br>
        {% for episode in manhwa.episodes.all %}
            <a href="#" class="episodes">{% trans 'Episode' %} : {{ episode.number }}</a>
        {% endfor %}<br><br>

        <h2 class="topic">{% trans 'write your comment : ' %}</h2>
        <form id="comment-form" action="{% url 'add_comment_manhwa' manhwa.id %}" method="post">
            {% csrf_token %}
            <h3 >*{% trans 'text' %} :</h3>
            <textarea class="text-area" name="text" cols="40" rows="6" required="" id="id_text"></textarea>
            <button class="btn-block" type="submit">{% trans 'send' %}</button>
        </form>
        <br>
        <br>
        <h2>{% trans 'comments' %} : </h2>

        <div id="comments-list" class="comments">
            {% for comment in comments %}
                <div class="comment-box">
                    <div class="comment-img">
                    </div>
                    <div class="comment-content">
                        <h3>{{ comment.author.username }}</h3>
                        <p>{{ comment.text|linebreaks }}</p>
                        <div class="comment-bottom">
                            <span>{{ comment.datetime_modified|timesince }}</span>
                            <div class="comment-reactions">
                                <button
                                        class="{% if comment.user_reaction == 'lk' %}active{% endif %}"
                                        onclick="reactionHandler({{ comment.id }}, 'lk')"
                                        id="comment-{{ comment.id }}-lk-count">
                                    lk:{{ comment.likes_count }}
                                </button>
                                <button
                                        class="{% if comment.user_reaction == 'dlk' %}active{% endif %}"
                                        onclick="reactionHandler({{ comment.id }}, 'dlk')"
                                        id="comment-{{ comment.id }}-dlk-count">
                                    dlk:{{ comment.dis_likes_count }}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    <br><br>

    </div>



{% endblock %}

{% block js %}
    <script src="{% static 'js/manhwa_detail.js' %}"></script>
{% endblock %}